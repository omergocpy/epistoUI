import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useEffect, useState } from 'react';
import HeaderDashboard from '../../../components/HeaderDashboard';
import FooterDashboard from '../../../components/FooterDashboard';
import Accordion from '../../../components/Accordion';
import { useParams } from 'react-router-dom';
import { SubmissionControllerApi } from '../../../api';
const BASE_API_URL = "http://45.80.174.126:18081";
const ScannerDetails = () => {
    const { id } = useParams();
    const [activeTab, setActiveTab] = useState('overview');
    const [scanDetails, setScanDetails] = useState(null);
    const [scanScreenshotDetails, setscanScreenshotDetails] = useState(null);
    const [currentIndex, setCurrentIndex] = useState(0);
    useEffect(() => {
        if (!id) {
            console.error("No id provided in URL");
            return;
        }
        const submissionId = Number(id);
        const submissionApi = new SubmissionControllerApi();
        submissionApi.screenshots(submissionId)
            .then((response) => {
            const data = response.data.data;
            setscanScreenshotDetails(data);
        })
            .catch((err) => {
            console.error("Submission API hatası:", err);
        });
    }, [id]);
    useEffect(() => {
        if (!id) {
            console.error("No id provided in URL");
            return;
        }
        const submissionId = Number(id);
        const submissionApi = new SubmissionControllerApi();
        submissionApi.detail(submissionId)
            .then((response) => {
            const data = response.data.data;
            setScanDetails(data);
        })
            .catch((err) => {
            console.error("Submission API hatası:", err);
        });
    }, [id]);
    const handleDownloadJson = () => {
        if (!scanDetails)
            return;
        const dataStr = JSON.stringify(scanDetails, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = window.URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = `scanner-details-${id}.json`;
        link.click();
        window.URL.revokeObjectURL(url);
    };
    const nextImage = () => {
        if (scanScreenshotDetails && scanScreenshotDetails.length > 0) {
            setCurrentIndex((prevIndex) => (prevIndex + 1) % scanScreenshotDetails.length);
        }
    };
    const prevImage = () => {
        if (scanScreenshotDetails && scanScreenshotDetails.length > 0) {
            setCurrentIndex((prevIndex) => (prevIndex - 1 + scanScreenshotDetails.length) % scanScreenshotDetails.length);
        }
    };
    const renderTabContent = () => {
        switch (activeTab) {
            case 'overview':
                return (_jsxs("div", { "data-tab-panel": "overview", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Risk ve \u00D6zeti" }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4", children: [_jsxs("div", { className: "bg-[#341818] border border-[#683131] rounded-xl p-4 flex flex-col gap-2", children: [_jsx("p", { className: "text-white text-base font-bold", children: "Malscore" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: scanDetails?.malscore !== undefined ? scanDetails.malscore : "N/A" })] }), _jsxs("div", { className: "bg-[#341818] border border-[#683131] rounded-xl p-4 flex flex-col gap-2", children: [_jsx("p", { className: "text-white text-base font-bold", children: "Malstatus" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: scanDetails?.malstatus || "N/A" })] }), _jsxs("div", { className: "bg-[#341818] border border-[#683131] rounded-xl p-4 flex flex-col gap-2", children: [_jsx("p", { className: "text-white text-base font-bold", children: "Suricata (#59)" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: scanDetails?.detections ? "Kural eşleşmesi (Network Exploit)" : "N/A" })] })] })] }));
            case 'file':
                return (_jsxs("div", { "data-tab-panel": "file", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Dosya Bilgisi" }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4", children: [_jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "Name" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.name || "N/A" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "Size" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.size ? `${scanDetails.target.file.size} bytes` : "N/A" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "CRC32" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.crc32 || "N/A" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "MD5" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.md5 || "N/A" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "SHA256" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.sha256 || "N/A" })] })] })] }));
            case 'pe':
                return (_jsxs("div", { "data-tab-panel": "pe", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "PE Bilgisi" }), _jsxs("div", { className: "flex flex-col gap-4", children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4", children: [_jsxs("div", { className: "bg-[#341818] p-4 rounded-xl border border-[#683131]", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "EntryPoint" }), _jsx("p", { className: "text-white text-base font-bold", children: scanDetails?.target?.file?.entryPoint || "N/A" })] }), _jsxs("div", { className: "bg-[#341818] p-4 rounded-xl border border-[#683131]", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "ep_bytes" }), _jsx("p", { className: "text-white text-base font-bold", children: "E9 4E 00 ..." })] }), _jsxs("div", { className: "bg-[#341818] p-4 rounded-xl border border-[#683131]", children: [_jsx("p", { className: "text-sm text-[#cb9090] font-medium", children: "OS Version" }), _jsx("p", { className: "text-white text-base font-bold", children: "6.3 (Win8.1+)" })] })] }), _jsx(Accordion, { title: "Imports", children: _jsxs("ul", { className: "list-disc list-inside text-white text-sm", children: [_jsx("li", { children: "mscoree.dll" }), _jsx("li", { children: "advapi32.dll" }), _jsx("li", { children: "ws2_32.dll" })] }) }), _jsx(Accordion, { title: "Exports", children: _jsxs("ul", { className: "list-decimal list-inside text-white text-sm", children: [_jsx("li", { children: "DllEntryPoint" }), _jsx("li", { children: "PluginMain" })] }) }), _jsx(Accordion, { title: "Sections", children: _jsxs("div", { className: "flex flex-col gap-2", children: [_jsxs("div", { className: "bg-[#492222] p-2 rounded-md text-white text-sm", children: [_jsxs("p", { children: ["Name: ", _jsx("span", { className: "text-[#cb9090]", children: ".text" })] }), _jsxs("p", { children: ["Entropy: ", _jsx("span", { className: "text-[#cb9090]", children: "6.32" })] }), _jsxs("p", { children: ["Characteristics: ", _jsx("span", { className: "text-[#cb9090]", children: "0x60000020" })] })] }), _jsxs("div", { className: "bg-[#492222] p-2 rounded-md text-white text-sm", children: [_jsxs("p", { children: ["Name: ", _jsx("span", { className: "text-[#cb9090]", children: ".data" })] }), _jsxs("p", { children: ["Entropy: ", _jsx("span", { className: "text-[#cb9090]", children: "5.12" })] }), _jsxs("p", { children: ["Characteristics: ", _jsx("span", { className: "text-[#cb9090]", children: "0xC0000040" })] })] })] }) }), _jsx(Accordion, { title: "Resources", children: _jsxs("div", { className: "bg-[#492222] p-2 rounded-md text-white text-sm", children: [_jsxs("p", { children: ["Name: ", _jsx("span", { className: "text-[#cb9090]", children: "ICON" })] }), _jsxs("p", { children: ["Language: ", _jsx("span", { className: "text-[#cb9090]", children: "1033" })] }), _jsxs("p", { children: ["Entropy: ", _jsx("span", { className: "text-[#cb9090]", children: "4.22" })] })] }) }), _jsxs(Accordion, { title: "VersionInfo", children: [_jsxs("div", { className: "bg-[#492222] p-2 rounded-md text-white text-sm", children: [_jsxs("p", { children: ["Name: ", _jsx("span", { className: "text-[#cb9090]", children: "FileVersion" })] }), _jsxs("p", { children: ["Value: ", _jsx("span", { className: "text-[#cb9090]", children: "2.0.0.1" })] })] }), _jsxs("div", { className: "bg-[#492222] p-2 rounded-md text-white text-sm", children: [_jsxs("p", { children: ["Name: ", _jsx("span", { className: "text-[#cb9090]", children: "CompanyName" })] }), _jsxs("p", { children: ["Value: ", _jsx("span", { className: "text-[#cb9090]", children: "Malicious Inc." })] })] })] })] })] }));
            case 'yara':
                return (_jsxs("div", { "data-tab-panel": "yara", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Yara / Cape Yara \u00D6rnekleri" }), _jsxs("div", { className: "flex flex-col gap-4", children: [_jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsxs("p", { className: "text-white text-base font-bold", children: ["Yara Kural: ", _jsx("span", { className: "text-[#cb9090]", children: "TrojanDownloader" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Strings: ", _jsx("span", { className: "text-[#cb9090]", children: "[\"$a = 'http://malicious.com/dl'\", \"$b = 'PE'\"]" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Adresler: ", _jsx("span", { className: "text-[#cb9090]", children: "[\"0x405000\", \"0x405050\"]" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Meta.desc: ", _jsx("span", { className: "text-[#cb9090]", children: "\u0130\u00E7erik indirerek sistemde \u00E7al\u0131\u015Ft\u0131ran trojan." })] })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsxs("p", { className: "text-white text-base font-bold", children: ["Cape Yara: ", _jsx("span", { className: "text-[#cb9090]", children: "RansomCape" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Cape Type: ", _jsx("span", { className: "text-[#cb9090]", children: "Ransom/Check" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Strings: ", _jsx("span", { className: "text-[#cb9090]", children: "[\"cape_str_rand\", \"enc_key= 'AES256'\"]" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Addresses: ", _jsx("span", { className: "text-[#cb9090]", children: "[\"0x501000\"]" })] })] })] })] }));
            case 'network':
                return (_jsxs("div", { "data-tab-panel": "network", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "A\u011F Aktiviteleri" }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-sm font-bold mb-2" }), _jsxs("p", { className: "text-white text-sm", children: ["Hosts IP: ", _jsx("span", { className: "text-[#cb9090]", children: "8.8.8.8, 34.34.34.10 (\u00FClke: US, tahmini)" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Dead Hosts: ", _jsx("span", { className: "text-[#cb9090]", children: "192.168.56.101 (LAN tarama ba\u015Far\u0131s\u0131z)" })] }), _jsxs("p", { className: "text-white text-sm", children: ["Domains: ", _jsx("span", { className: "text-[#cb9090]", children: "[\"malicious.com\",\"example.org\"]" })] })] })] }));
            case 'behavior':
                return (_jsxs("div", { "data-tab-panel": "behavior", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Davran\u0131\u015F Kay\u0131tlar\u0131 " }), _jsxs("div", { className: "flex flex-col gap-2", children: [_jsx("div", { className: "flex items-center gap-4 bg-[#231010] px-4 py-2 justify-between", children: _jsxs("div", { className: "flex flex-col", children: [_jsx("p", { className: "text-white text-sm font-medium", children: "CreateProcess - powershell.exe" }), _jsx("p", { className: "text-[#cb9090] text-xs", children: "~1 saat \u00F6nce" })] }) }), _jsx("div", { className: "flex items-center gap-4 bg-[#231010] px-4 py-2 justify-between", children: _jsxs("div", { className: "flex flex-col", children: [_jsx("p", { className: "text-white text-sm font-medium", children: "CopyFile - C:\\Users\\Public\\mal.dll" }), _jsx("p", { className: "text-[#cb9090] text-xs", children: "~45 dk \u00F6nce" })] }) }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl mt-4", children: [_jsx("p", { className: "text-white text-sm font-bold", children: "debug.log" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "\u201CRDP oturumu kapat\u0131ld\u0131 - normal sonlanma. 0x00.\u201D" })] })] })] }));
            case 'extra':
                return (_jsxs("div", { "data-tab-panel": "extra", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Ekstra Bilgiler" }), _jsxs("div", { className: "flex flex-col gap-4", children: [_jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: "Detection Family" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "Trojan.Win32.CryptoRansom" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: ".dotnet" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "No .NET metadata found" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: "die" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "PE32+ console - MS Visual C++ 2015" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: "selfextract.de4dot.extracted_files" }), _jsxs("ul", { className: "list-disc list-inside text-white text-sm", children: [_jsx("li", { children: "payload.dll" }), _jsx("li", { children: "key.dat" })] })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: "procdump" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "\u201C2 adet dump olu\u015Fturuldu.\u201D" })] }), _jsxs("div", { className: "bg-[#341818] p-4 border border-[#683131] rounded-xl", children: [_jsx("p", { className: "text-white text-base font-bold", children: "CAPE[*].? ek verisi" }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "Suspicious injection alg\u0131lamas\u0131 (CAPE - Example)" })] })] })] }));
            case 'screenshots':
                return (_jsxs("div", { "data-tab-panel": "screenshots", className: "py-6", children: [_jsx("h3", { className: "text-white text-lg font-bold mb-3", children: "Tarama Ekran G\u00F6r\u00FCnt\u00FCleri" }), _jsx("p", { className: "text-[#cb9090] text-sm mb-5", children: "Burada tarama s\u0131ras\u0131nda al\u0131nan ekran g\u00F6r\u00FCnt\u00FCleri slayt g\u00F6sterimi \u015Feklinde sunulacakt\u0131r." }), scanScreenshotDetails && scanScreenshotDetails.length > 0 ? (_jsxs("div", { className: "relative w-full max-w-4xl mx-auto", children: [_jsx("div", { className: "overflow-hidden rounded-lg shadow-xl", children: _jsx("img", { src: `${BASE_API_URL}${scanScreenshotDetails[currentIndex].path}`, alt: `Screenshot ${currentIndex + 1}`, className: "w-full h-auto object-cover transition-all duration-500 ease-in-out" }) }), _jsx("button", { onClick: prevImage, className: "absolute top-1/2 left-3 transform -translate-y-1/2 bg-red-700 hover:bg-red-800 text-white p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400", children: "<" }), _jsx("button", { onClick: nextImage, className: "absolute top-1/2 right-3 transform -translate-y-1/2 bg-red-700 hover:bg-red-800 text-white p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-red-400", children: ">" }), _jsx("div", { className: "absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2", children: scanScreenshotDetails.map((_, index) => (_jsx("button", { onClick: () => setCurrentIndex(index), className: `w-3 h-3 rounded-full focus:outline-none ${index === currentIndex ? 'bg-red-700' : 'bg-gray-400'}` }, index))) })] })) : (_jsx("p", { className: "text-white", children: "Ekran g\u00F6r\u00FCnt\u00FCs\u00FC bulunamad\u0131." }))] }));
                return null;
        }
    };
    return (_jsxs("div", { className: "min-h-screen bg-[#231010] text-white", style: { fontFamily: '"Space Grotesk", "Noto Sans", sans-serif' }, children: [_jsx(HeaderDashboard, {}), _jsxs("main", { className: "px-10 py-5 flex-1 flex flex-col max-w-[1200px] mx-auto w-full", children: [_jsxs("div", { className: "flex justify-between items-center flex-wrap gap-3", children: [_jsxs("div", { className: "flex flex-col", children: [_jsxs("p", { className: "text-white text-2xl font-bold", children: ["Rapor #", scanDetails?.info?.id || "20230101"] }), _jsx("p", { className: "text-[#cb9090] text-sm", children: "(\u00D6rnek veri) - 2 saat \u00F6nce g\u00F6nderildi" })] }), _jsxs("div", { className: "flex gap-2 items-center", children: [_jsxs("p", { className: "text-white text-sm", children: ["Makine: ", _jsx("span", { className: "text-[#cb9090]", children: scanDetails?.info?.machine?.name || "Win10-64 " })] }), _jsxs("p", { className: "text-white text-sm", children: ["Kategori: ", _jsx("span", { className: "text-[#cb9090]", children: scanDetails?.info?.category || "Suspicious .exe" })] }), _jsx("button", { className: "flex items-center justify-center h-8 px-4 rounded-xl bg-[#492222] text-white text-sm font-medium", children: "Tekrar Analiz" }), _jsx("button", { onClick: handleDownloadJson, className: "flex items-center justify-center h-8 px-4 rounded-xl bg-[#f20d0d] text-white text-sm font-medium", children: "JSON \u0130ndir" })] })] }), _jsx("div", { className: "mt-4 border-b border-[#683131]", children: _jsxs("div", { className: "flex gap-6 text-[#cb9090]", children: [_jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'overview' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('overview'), children: "Genel Bak\u0131\u015F" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'file' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('file'), children: "Dosya" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'pe' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('pe'), children: "PE Bilgisi" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'yara' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('yara'), children: "Yara & Cape" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'network' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('network'), children: "A\u011F" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'behavior' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('behavior'), children: "Davran\u0131\u015F" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'extra' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('extra'), children: "Ekstra" }), _jsx("button", { className: `pb-2 border-b-2 ${activeTab === 'screenshots' ? 'border-b-[#f20d0d] text-white' : 'border-b-transparent text-[#cb9090]'}`, onClick: () => setActiveTab('screenshots'), children: "Ekran G\u00F6r\u00FCnt\u00FCleri" })] }) }), _jsx("div", { className: "mt-4 flex-1", children: renderTabContent() })] }), _jsx(FooterDashboard, {})] }));
};
export default ScannerDetails;
